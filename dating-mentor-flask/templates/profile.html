{% extends "base.html" %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - –ò–ò-–ú–µ–Ω—Ç–æ—Ä –¥–ª—è –¥–µ–π—Ç–∏–Ω–≥–∞{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <h1 class="mb-4">
                <i class="fas fa-user-circle"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
            </h1>
            
            <!-- Current User Info -->
            {% if current_user %}
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <div class="avatar-large bg-gradient-primary text-white">
                                {{ current_user.name[0].upper() }}
                            </div>
                        </div>
                        <div class="col">
                            <h3 class="mb-1">{{ current_user.name }}</h3>
                            <p class="text-muted mb-2">
                                <i class="fas fa-birthday-cake"></i> {{ current_user.age }} –ª–µ—Ç
                                <span class="mx-2">‚Ä¢</span>
                                <i class="fas fa-heart"></i> {{ current_user.dating_goals }}
                                <span class="mx-2">‚Ä¢</span>
                                {{ current_user.personality_type }} {{ current_user.personality_type|get_personality_emoji }}
                            </p>
                            <p class="mb-0"><strong>–ò–Ω—Ç–µ—Ä–µ—Å—ã:</strong> {{ current_user.interests }}</p>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#editProfileModal">
                                <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <a href="{{ url_for('chat') }}" class="text-decoration-none">
                        <div class="action-card text-center">
                            <i class="fas fa-comments fa-3x text-primary mb-3"></i>
                            <h5>–ù–∞—á–∞—Ç—å —á–∞—Ç</h5>
                            <p class="text-muted">–ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏</p>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="{{ url_for('analyze') }}" class="text-decoration-none">
                        <div class="action-card text-center">
                            <i class="fas fa-user-check fa-3x text-success mb-3"></i>
                            <h5>–ê–Ω–∞–ª–∏–∑ –∞–Ω–∫–µ—Ç—ã</h5>
                            <p class="text-muted">–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</p>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="{{ url_for('analyze') }}#photo-tips" class="text-decoration-none">
                        <div class="action-card text-center">
                            <i class="fas fa-camera fa-3x text-info mb-3"></i>
                            <h5>–°–æ–≤–µ—Ç—ã –ø–æ —Ñ–æ—Ç–æ</h5>
                            <p class="text-muted">–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</p>
                        </div>
                    </a>
                </div>
            </div>
            
            {% else %}
            
            <!-- User Selection -->
            {% if users %}
            <div class="card mb-4">
                <div class="card-body">
                    <h4 class="card-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å</h4>
                    <select class="form-select" id="userSelect">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å --</option>
                        {% for user in users %}
                        <option value="{{ user.id }}">
                            {{ user.name }} ({{ user.age }} –ª–µ—Ç)
                        </option>
                        {% endfor %}
                        <option value="new">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å</option>
                    </select>
                </div>
            </div>
            {% endif %}
            
            <!-- Create Profile Form -->
            <div class="card">
                <div class="card-body">
                    <h4 class="card-title mb-4">
                        <i class="fas fa-user-plus"></i> –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
                    </h4>
                    
                    <form id="createUserForm">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">–ò–º—è *</label>
                                <input type="text" class="form-control" name="name" required 
                                       placeholder="–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç *</label>
                                <input type="number" class="form-control" name="age" 
                                       min="18" max="100" value="25" required>
                            </div>
                            <div class="col-12">
                                <label class="form-label">–û —Å–µ–±–µ *</label>
                                <textarea class="form-control" name="bio" rows="3" required
                                          placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –æ —Å–µ–±–µ..."></textarea>
                            </div>
                            <div class="col-12">
                                <label class="form-label">–ò–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Ö–æ–±–±–∏</label>
                                <textarea class="form-control" name="interests" rows="2"
                                          placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, –∫–∏–Ω–æ, —Å–ø–æ—Ä—Ç, –∫–Ω–∏–≥–∏..."></textarea>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">–¶–µ–ª–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤</label>
                                <select class="form-select" name="dating_goals">
                                    <option value="–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è">–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</option>
                                    <option value="–õ–µ–≥–∫–æ–µ –æ–±—â–µ–Ω–∏–µ">–õ–µ–≥–∫–æ–µ –æ–±—â–µ–Ω–∏–µ</option>
                                    <option value="–î—Ä—É–∂–±–∞">–î—Ä—É–∂–±–∞</option>
                                    <option value="–ù–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è">–ù–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">–¢–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏</label>
                                <select class="form-select" name="personality_type">
                                    <option value="–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç">–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç üéâ</option>
                                    <option value="–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç">–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç ü§î</option>
                                    <option value="–ê–º–±–∏–≤–µ—Ä—Ç">–ê–º–±–∏–≤–µ—Ä—Ç ü§ù</option>
                                    <option value="–ù–µ –∑–Ω–∞—é">–ù–µ –∑–Ω–∞—é ‚ùì</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary btn-lg w-100">
                                    <i class="fas fa-rocket"></i> –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
{% if current_user %}
<div class="modal fade" id="editProfileModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="editUserForm">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">–ò–º—è</label>
                            <input type="text" class="form-control" name="name" 
                                   value="{{ current_user.name }}" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç</label>
                            <input type="number" class="form-control" name="age" 
                                   value="{{ current_user.age }}" min="18" max="100" required>
                        </div>
                        <div class="col-12">
                            <label class="form-label">–û —Å–µ–±–µ</label>
                            <textarea class="form-control" name="bio" rows="3" required>{{ current_user.bio }}</textarea>
                        </div>
                        <div class="col-12">
                            <label class="form-label">–ò–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Ö–æ–±–±–∏</label>
                            <textarea class="form-control" name="interests" rows="2">{{ current_user.interests }}</textarea>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">–¶–µ–ª–∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤</label>
                            <select class="form-select" name="dating_goals">
                                <option value="–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è" {% if current_user.dating_goals == "–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è" %}selected{% endif %}>–°–µ—Ä—å–µ–∑–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è</option>
                                <option value="–õ–µ–≥–∫–æ–µ –æ–±—â–µ–Ω–∏–µ" {% if current_user.dating_goals == "–õ–µ–≥–∫–æ–µ –æ–±—â–µ–Ω–∏–µ" %}selected{% endif %}>–õ–µ–≥–∫–æ–µ –æ–±—â–µ–Ω–∏–µ</option>
                                <option value="–î—Ä—É–∂–±–∞" {% if current_user.dating_goals == "–î—Ä—É–∂–±–∞" %}selected{% endif %}>–î—Ä—É–∂–±–∞</option>
                                <option value="–ù–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è" {% if current_user.dating_goals == "–ù–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è" %}selected{% endif %}>–ù–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">–¢–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏</label>
                            <select class="form-select" name="personality_type">
                                <option value="–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç" {% if current_user.personality_type == "–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç" %}selected{% endif %}>–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç üéâ</option>
                                <option value="–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç" {% if current_user.personality_type == "–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç" %}selected{% endif %}>–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç ü§î</option>
                                <option value="–ê–º–±–∏–≤–µ—Ä—Ç" {% if current_user.personality_type == "–ê–º–±–∏–≤–µ—Ä—Ç" %}selected{% endif %}>–ê–º–±–∏–≤–µ—Ä—Ç ü§ù</option>
                                <option value="–ù–µ –∑–Ω–∞—é" {% if current_user.personality_type == "–ù–µ –∑–Ω–∞—é" %}selected{% endif %}>–ù–µ –∑–Ω–∞—é ‚ùì</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary" onclick="saveProfile()">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
            </div>
        </div>
    </div>
</div>
{% endif %}

<style>
.avatar-large {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: 700;
}

.action-card {
    background: white;
    padding: 2rem;
    border-radius: 20px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    height: 100%;
}

.action-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
}

.action-card h5 {
    color: var(--dark-color);
}
</style>
{% endblock %}
